(self.webpackChunkfishing_study_app=self.webpackChunkfishing_study_app||[]).push([[259],{7259:(t,e,o)=>{"use strict";o.r(e),o.d(e,{DocumentModule:()=>w});var n=o(1116),i=o(3337),c=o(1267),l=o(2501),r=o.n(l),a=o(5366),s=o(6052),u=o(5842),p=o(6530),d=o(2290),m=o(9848),f=o(9106),g=o(7593),h=o(6726);const b=["fileUploader"];function Z(t,e){1&t&&a._uU(0,"Cargar Archivo")}function A(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"p-fileUpload",8,9),a.NdJ("uploadHandler",function(e){return a.CHM(t),a.oxw(2).loadFile(e)}),a.qZA()}2&t&&a.Q6J("customUpload",!0)}function U(t,e){1&t&&(a.TgZ(0,"p-accordion",2),a.TgZ(1,"p-accordionTab"),a.YNc(2,Z,1,0,"ng-template",5),a.YNc(3,A,2,1,"ng-template",7),a.qZA(),a.qZA())}function x(t,e){1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"th"),a._uU(2,"Nombre"),a.qZA(),a.TgZ(3,"th"),a._uU(4,"Formato"),a.qZA(),a.TgZ(5,"th"),a._uU(6,"Subido por"),a.qZA(),a.TgZ(7,"th"),a._uU(8,"Fecha"),a.qZA(),a.TgZ(9,"th"),a._uU(10,"Archivo"),a.qZA(),a.qZA())}function T(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",13),a.NdJ("click",function(){a.CHM(t);const e=a.oxw().$implicit;return a.oxw().deleteDocument(e)}),a.qZA()}}function q(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"tr"),a.TgZ(1,"td",10),a._uU(2),a.ALo(3,"slice"),a.qZA(),a.TgZ(4,"td"),a._uU(5),a.qZA(),a.TgZ(6,"td"),a._uU(7),a.qZA(),a.TgZ(8,"td"),a._uU(9),a.ALo(10,"date"),a.qZA(),a.TgZ(11,"td"),a.TgZ(12,"button",11),a.NdJ("click",function(){const e=a.CHM(t).$implicit;return a.oxw().descargar(e.file,e.name)}),a.qZA(),a.YNc(13,T,1,0,"button",12),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit,o=a.oxw();a.xp6(1),a.Q6J("pTooltip",t.name.split(".").slice(0,-1).join(".")),a.xp6(1),a.Oqu(t.name.split(".").slice(0,-1).join(".").length>33?a.Dn7(3,6,t.name.split(".").slice(0,-1).join("."),0,33)+"...":t.name.split(".").slice(0,-1).join(".")),a.xp6(3),a.hij(" ",t.name.split(".").pop(),""),a.xp6(2),a.Oqu(t.ownerDocument),a.xp6(2),a.Oqu(a.xi3(10,10,t.uploadDate,"medium")),a.xp6(4),a.Q6J("ngIf",o.canAccess)}}const C=[{path:"",component:(()=>{class t{constructor(t,e){this.fileUploadService=t,this.authService=e,this.documents=[],this.canAccess="encuestador"!==this.authService.user.role,this.document={_id:"",file:"",name:"",uploadDate:"",ownerDocument:""}}ngOnInit(){this.getDocuments()}getDocuments(){this.fileUploadService.getDocuments().subscribe(({documents:t})=>{t.forEach(t=>{""!==t.file&&(t.file=`${c.N.baseUrl}/upload/documentos/${t.file}`)}),this.documents=t})}loadFile(t){this.uploadFile=t.files[0],this.fileUploadService.loadFile(this.uploadFile,"documentos").finally(()=>{r().fire({icon:"success",title:"Archivo subido con exito!",showConfirmButton:!1,timer:1500}).then(()=>{this.fileUploadService.getDocuments().subscribe(({documents:t})=>{t.forEach(t=>{""!==t.file&&(t.file=`${c.N.baseUrl}/upload/documentos/${t.file}`)}),this.documents=t})})}),this.fileUploader.clear()}descargar(t,e){if(t){const e=document.createElement("a");e.href=t,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else r().fire({background:"rgba(250,250,250,0.96)",title:"Oops!!",text:"Error 504: Archivo no encontrado.",icon:"error",confirmButtonColor:"#3085d6"})}deleteDocument(t){r().fire({title:"Borrar documento",text:"\xbfEsta seguro que desea eliminar este archivo de forma permanente?",icon:"question",iconColor:"#3085d6",showCancelButton:!0,confirmButtonColor:"#2F6FC6",cancelButtonColor:"#2F6FC6",confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&this.fileUploadService.deleteDocument(t).subscribe(t=>{r().fire({title:"Eliminado!",text:"Archivo eliminado correctamente",icon:"success",showConfirmButton:!1,timer:1500}),this.getDocuments()})}).then(()=>{this.fileUploadService.getDocuments().subscribe(({documents:t})=>{t.forEach(t=>{""!==t.file&&(t.file=`${c.N.baseUrl}/upload/documentos/${t.file}`)}),this.documents=t})})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(s.J),a.Y36(u.e))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-document"]],viewQuery:function(t,e){if(1&t&&a.Gf(b,5),2&t){let t;a.iGM(t=a.CRH())&&(e.fileUploader=t.first)}},decls:9,vars:4,consts:[[1,"back"],["id","doc-container",1,"m-5"],[1,"m-2"],["class","m-2",4,"ngIf"],["styleClass","p-datatable-gridlines",3,"value","paginator","rows"],["pTemplate","header"],["pTemplate","body"],["pTemplate","content"],["name","archivo","accept",".xlsx,.xls,.doc,.docx,.ppt,.pptx,.pdf","chooseLabel","Elegir","uploadLabel","Cargar","cancelLabel","Cancelar",3,"customUpload","uploadHandler"],["fileUploader",""],[3,"pTooltip"],["pButton","","type","button","icon","pi pi-download","iconPos","left",1,"p-button-outlined","p-button-rounded","btn","p-button-lg",3,"click"],["pButton","","type","button","class","p-button-outlined p-button-rounded btn p-button-lg","icon","pi pi-trash","iconPos","left",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-trash","iconPos","left",1,"p-button-outlined","p-button-rounded","btn","p-button-lg",3,"click"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"h1",2),a._uU(3,"Documentos"),a.qZA(),a._UZ(4,"hr"),a.YNc(5,U,4,0,"p-accordion",3),a.TgZ(6,"p-table",4),a.YNc(7,x,11,0,"ng-template",5),a.YNc(8,q,14,13,"ng-template",6),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(5),a.Q6J("ngIf",e.canAccess),a.xp6(1),a.Q6J("value",e.documents)("paginator",!0)("rows",10))},directives:[n.O5,p.iA,d.jx,m.UQ,m.US,f.p,g.u,h.Hq],pipes:[n.OU,n.uU],styles:[".back[_ngcontent-%COMP%]{position:fixed;top:56px;bottom:0;left:0;right:0;z-index:100;background-image:url(90.ea64f17445f9bd7c9ac7.png);background-position:50%;background-repeat:no-repeat;background-size:cover}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:center!important}th[_ngcontent-%COMP%]{color:#fff!important;background-color:#3f51b5!important}.btn[_ngcontent-%COMP%]{margin:1rem;color:#47b1b1}"]}),t})(),pathMatch:"full"}];let v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[i.Bz.forChild(C)],i.Bz]}),t})();var _=o(4784),k=o(5180);let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[n.ez,v,k.W,_.q]]}),t})()}}]);