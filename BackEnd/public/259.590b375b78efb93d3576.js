(self.webpackChunkfishing_study_app=self.webpackChunkfishing_study_app||[]).push([[259],{7259:(t,e,o)=>{"use strict";o.r(e),o.d(e,{DocumentModule:()=>B});var n=o(1116),i=o(3337),c=o(1267),a=o(2501),r=o.n(a),l=o(5366),u=o(6052),s=o(5842),p=o(5592),d=o(2290),m=o(9848),f=o(7672),g=o(9106),h=o(7593),b=o(6726);const Z=["fileUploader"];function x(t,e){1&t&&l._UZ(0,"mat-spinner",10)}function A(t,e){if(1&t&&(l.TgZ(0,"h6",8),l._uU(1,"Cargar Archivo"),l.qZA(),l.YNc(2,x,1,0,"mat-spinner",9)),2&t){const t=l.oxw(2);l.xp6(2),l.Q6J("ngIf",t.cargando)}}function U(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"p-fileUpload",11,12),l.NdJ("uploadHandler",function(e){return l.CHM(t),l.oxw(2).loadFile(e)}),l.qZA()}2&t&&l.Q6J("customUpload",!0)}function C(t,e){1&t&&(l.TgZ(0,"p-accordion",2),l.TgZ(1,"p-accordionTab"),l.YNc(2,A,3,1,"ng-template",5),l.YNc(3,U,2,1,"ng-template",7),l.qZA(),l.qZA())}function v(t,e){1&t&&(l.TgZ(0,"tr"),l.TgZ(1,"th"),l._uU(2,"Nombre"),l.qZA(),l.TgZ(3,"th"),l._uU(4,"Formato"),l.qZA(),l.TgZ(5,"th"),l._uU(6,"Subido por"),l.qZA(),l.TgZ(7,"th"),l._uU(8,"Fecha"),l.qZA(),l.TgZ(9,"th"),l._uU(10,"Archivo"),l.qZA(),l.qZA())}function T(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"button",16),l.NdJ("click",function(){l.CHM(t);const e=l.oxw().$implicit;return l.oxw().deleteDocument(e)}),l.qZA()}}function q(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"tr"),l.TgZ(1,"td",13),l._uU(2),l.ALo(3,"slice"),l.qZA(),l.TgZ(4,"td"),l._uU(5),l.qZA(),l.TgZ(6,"td"),l._uU(7),l.qZA(),l.TgZ(8,"td"),l._uU(9),l.ALo(10,"date"),l.qZA(),l.TgZ(11,"td"),l.TgZ(12,"button",14),l.NdJ("click",function(){const e=l.CHM(t).$implicit;return l.oxw().descargar(e.file,e.name)}),l.qZA(),l.YNc(13,T,1,0,"button",15),l.qZA(),l.qZA()}if(2&t){const t=e.$implicit,o=l.oxw();l.xp6(1),l.Q6J("pTooltip",t.name.split(".").slice(0,-1).join(".")),l.xp6(1),l.Oqu(t.name.split(".").slice(0,-1).join(".").length>33?l.Dn7(3,6,t.name.split(".").slice(0,-1).join("."),0,33)+"...":t.name.split(".").slice(0,-1).join(".")),l.xp6(3),l.hij(" ",t.name.split(".").pop(),""),l.xp6(2),l.Oqu(t.ownerDocument),l.xp6(2),l.Oqu(l.xi3(10,10,t.uploadDate,"medium")),l.xp6(4),l.Q6J("ngIf",o.canAccess)}}const _=[{path:"",component:(()=>{class t{constructor(t,e){this.fileUploadService=t,this.authService=e,this.documents=[],this.canAccess="encuestador"!==this.authService.user.role,this.document={_id:"",file:"",name:"",uploadDate:"",ownerDocument:""},this.cargando=!1}ngOnInit(){this.getDocuments()}getDocuments(){this.fileUploadService.getDocuments().subscribe(({documents:t})=>{t.forEach(t=>{""!==t.file&&(t.file=`${c.N.baseUrl}/upload/documentos/${t.file}`)}),this.documents=t})}loadFile(t){this.cargando=!0,this.uploadFile=t.files[0],this.fileUploadService.loadFile(this.uploadFile,"documentos").finally(()=>{r().fire({icon:"success",title:"Archivo subido con exito!",showConfirmButton:!1,timer:1500}).then(()=>{this.fileUploadService.getDocuments().subscribe(({documents:t})=>{t.forEach(t=>{""!==t.file&&(t.file=`${c.N.baseUrl}/upload/documentos/${t.file}`)}),this.documents=t})}),this.cargando=!1}),this.fileUploader.clear()}descargar(t,e){if(t){const e=document.createElement("a");e.href=t,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else r().fire({background:"rgba(250,250,250,0.96)",title:"Oops!!",text:"Error 504: Archivo no encontrado.",icon:"error",confirmButtonColor:"#3085d6"})}deleteDocument(t){r().fire({title:"Borrar documento",text:"\xbfEsta seguro que desea eliminar este archivo de forma permanente?",icon:"question",iconColor:"#3085d6",showCancelButton:!0,confirmButtonColor:"#2F6FC6",cancelButtonColor:"#2F6FC6",confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&this.fileUploadService.deleteDocument(t).subscribe(t=>{r().fire({title:"Eliminado!",text:"Archivo eliminado correctamente",icon:"success",showConfirmButton:!1,timer:1500}),this.getDocuments()})}).then(()=>{this.fileUploadService.getDocuments().subscribe(({documents:t})=>{t.forEach(t=>{""!==t.file&&(t.file=`${c.N.baseUrl}/upload/documentos/${t.file}`)}),this.documents=t})})}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(u.J),l.Y36(s.e))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-document"]],viewQuery:function(t,e){if(1&t&&l.Gf(Z,5),2&t){let t;l.iGM(t=l.CRH())&&(e.fileUploader=t.first)}},decls:9,vars:5,consts:[[1,"back"],["id","doc-container",1,"mx-5","mt-3"],[1,"m-2"],["class","m-2",4,"ngIf"],["styleClass","p-datatable-gridlines",3,"value","autoLayout","paginator","rows"],["pTemplate","header"],["pTemplate","body"],["pTemplate","content"],[1,"me-4"],["color","accent","diameter","40",4,"ngIf"],["color","accent","diameter","40"],["name","archivo","accept",".xlsx,.xls,.doc,.docx,.ppt,.pptx,.pdf","chooseLabel","Elegir","uploadLabel","Cargar","cancelLabel","Cancelar",3,"customUpload","uploadHandler"],["fileUploader",""],[3,"pTooltip"],["pButton","","type","button","icon","pi pi-download","iconPos","left",1,"p-button-outlined","p-button-rounded","btn","p-button-lg",3,"click"],["pButton","","type","button","class","p-button-outlined p-button-rounded btn p-button-lg","icon","pi pi-trash","iconPos","left",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-trash","iconPos","left",1,"p-button-outlined","p-button-rounded","btn","p-button-lg",3,"click"]],template:function(t,e){1&t&&(l._UZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"h1",2),l._uU(3,"Documentos"),l.qZA(),l._UZ(4,"hr"),l.YNc(5,C,4,0,"p-accordion",3),l.TgZ(6,"p-table",4),l.YNc(7,v,11,0,"ng-template",5),l.YNc(8,q,14,13,"ng-template",6),l.qZA(),l.qZA()),2&t&&(l.xp6(5),l.Q6J("ngIf",e.canAccess),l.xp6(1),l.Q6J("value",e.documents)("autoLayout",!0)("paginator",!0)("rows",10))},directives:[n.O5,p.iA,d.jx,m.UQ,m.US,f.$g,g.p,h.u,b.Hq],pipes:[n.OU,n.uU],styles:[".back[_ngcontent-%COMP%]{position:absolute;top:56px;bottom:0;width:100%;min-height:100vh;background-image:url(90.ea64f17445f9bd7c9ac7.png);background-position:50%;background-repeat:no-repeat;background-size:cover}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:center!important}th[_ngcontent-%COMP%]{color:#fff!important;background-color:#3f51b5!important}tr[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:#f5f5f5}tr[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.btn[_ngcontent-%COMP%]{margin:1rem;color:#47b1b1}"]}),t})(),pathMatch:"full"}];let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.Bz.forChild(_)],i.Bz]}),t})();var k=o(4886),y=o(5674);let B=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[n.ez,w,y.W,k.q]]}),t})()}}]);