(self.webpackChunkfishing_study_app=self.webpackChunkfishing_study_app||[]).push([[446],{1446:(t,e,i)=>{"use strict";i.r(e),i.d(e,{EditProfileModule:()=>I});var a=i(1116),r=i(3337),o=i(1041),s=i(4689),u=i(529),n=i(5366),d=i(1990),l=i(5842),c=i(4369);let m=(()=>{class t{constructor(t,e,i,a,r){this.fb=t,this.userService=e,this.authService=i,this.activatedRoute=a,this.router=r,this.usuarioActual=this.authService.user,this.user={uid:"",name:"",email:"",role:"",state:!0,img:""},this._baseUrl=u.N.baseUrl,this.imageUrl="",this.editForm=this.fb.group({name:["",[o.kI.required],[]],email:["",[o.kI.required,o.kI.email],[]],role:["",[o.kI.required],[]],state:["",[o.kI.required],[]]}),this.editPassword=this.fb.group({oldPassword:["",[o.kI.required],[]],newPassword:["",[o.kI.required,o.kI.pattern(this.authService.passwordRegex)],[]],confirmPassword:["",[o.kI.required],[this.authService.samePassword]]})}ngOnInit(){this.activatedRoute.params.pipe((0,s.w)(t=>(this.uid=t.uid,this.userService.getUsers(t.uid)))).subscribe(t=>{var e,i;this.prueba=t,this.user=this.prueba.usuario,this.editForm.patchValue({name:this.prueba.usuario.name,email:this.prueba.usuario.email}),null===(e=this.editForm.get("role"))||void 0===e||e.patchValue(this.prueba.usuario.role),null===(i=this.editForm.get("state"))||void 0===i||i.patchValue(this.prueba.usuario.state),this.imageUrl=this.getImageUrl(this.user)})}getImageUrl(t){return t.img?`${this._baseUrl}/upload/usuarios/${t.img}`:`${this._baseUrl}/upload/usuarios/no-image`}mostrar(t){"G"===t?this.router.navigateByUrl(`home-page/edit-profile/${this.uid}/edit-profile/${this.uid}`):"P"===t&&this.router.navigateByUrl(`home-page/edit-profile/${this.uid}/update-password/${this.uid}`)}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(o.qu),n.Y36(d.K),n.Y36(l.e),n.Y36(r.gz),n.Y36(r.F0))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-edit-profile"]],decls:25,vars:0,consts:[[1,"prueba","pt-4","px-5",2,"color","#414042"],[2,"margin","0"],["height","10","width","300"],["x1","0","y1","0","x2","150","y2","0"],[1,"row"],[1,"col-3"],["mat-button","",1,"my-2","btn-opt",3,"click"],["src","../../../../assets/profile/usuarioA.png","alt","",1,"imgIcon"],["mat-button","",1,"mb-2","btn-opt",3,"click"],["src","../../../../assets/profile/contrasenaA.png","alt","",1,"imgIcon"],["mat-button","",1,"mb-2","btn-opt"],["src","../../../../assets/profile/infoA.png","alt","",1,"imgIcon"],["src","../../../../assets/profile/participacionA.png","alt","",1,"imgIcon"],["src","../../../../assets/profile/campana-de-notificacionA.png","alt","",1,"imgIcon"],[1,"col-9"],[1,"p-4","container"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"h1",1),n._uU(2,"Ajustes de cuenta"),n.qZA(),n.O4$(),n.TgZ(3,"svg",2),n._UZ(4,"line",3),n.qZA(),n.kcU(),n.TgZ(5,"div",4),n.TgZ(6,"div",5),n.TgZ(7,"button",6),n.NdJ("click",function(){return e.mostrar("G")}),n._UZ(8,"img",7),n._uU(9,"General"),n.qZA(),n.TgZ(10,"button",8),n.NdJ("click",function(){return e.mostrar("P")}),n._UZ(11,"img",9),n._uU(12,"Cambiar contrase\xf1a"),n.qZA(),n.TgZ(13,"button",10),n._UZ(14,"img",11),n._uU(15,"Informacion"),n.qZA(),n.TgZ(16,"button",10),n._UZ(17,"img",12),n._uU(18,"Social"),n.qZA(),n.TgZ(19,"button",10),n._UZ(20,"img",13),n._uU(21,"Notificaciones"),n.qZA(),n.qZA(),n.TgZ(22,"div",14),n.TgZ(23,"div",15),n._UZ(24,"router-outlet"),n.qZA(),n.qZA(),n.qZA(),n.qZA())},directives:[c.lW,r.lC],styles:["line[_ngcontent-%COMP%]{stroke:#ff4081;stroke-width:8}.imgIcon[_ngcontent-%COMP%]{width:30px;height:30px;margin-right:15px}.prueba[_ngcontent-%COMP%]{position:fixed;top:56px;bottom:0;left:0;right:0;z-index:100;background-image:url(90.ea64f17445f9bd7c9ac7.png);background-position:50%;background-repeat:no-repeat;background-size:cover}.btn-opt[_ngcontent-%COMP%]{width:100%;height:48px;text-align:left}.container[_ngcontent-%COMP%]{width:100%;border-radius:10px;background-color:#fafafa;color:#414042}"]}),t})();var p=i(2501),g=i.n(p),h=i(6052),f=i(3070),Z=i(9550),b=i(7307),q=i(7436);function v(t,e){if(1&t&&n._UZ(0,"img",18),2&t){const t=n.oxw();n.Q6J("src",t.imageUrl,n.LSH)}}function A(t,e){if(1&t&&n._UZ(0,"img",18),2&t){const t=n.oxw();n.Q6J("src",t.imgTemp,n.LSH)}}function U(t,e){1&t&&(n.TgZ(0,"div",9),n.TgZ(1,"mat-form-field",10),n.TgZ(2,"mat-label"),n._uU(3,"Rol"),n.qZA(),n.TgZ(4,"select",19),n.TgZ(5,"option",20),n._uU(6,"Admin"),n.qZA(),n.TgZ(7,"option",21),n._uU(8,"Cient\xedfico comunitario"),n.qZA(),n.TgZ(9,"option",22),n._uU(10,"Encuestador"),n.qZA(),n.qZA(),n.TgZ(11,"mat-icon",12),n._uU(12,"people"),n.qZA(),n.qZA(),n.qZA())}function _(t,e){1&t&&(n.TgZ(0,"div",9),n.TgZ(1,"mat-icon",23),n._uU(2,"how_to_reg"),n.qZA(),n.TgZ(3,"label",24),n._uU(4,"Estado: "),n.qZA(),n.TgZ(5,"mat-radio-group",25),n.TgZ(6,"mat-radio-button",26),n._uU(7," Activo "),n.qZA(),n.TgZ(8,"mat-radio-button",26),n._uU(9," Inactivo "),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(6),n.Q6J("value",!0),n.xp6(2),n.Q6J("value",!1))}const T=[{path:"",component:m,children:[{path:"edit-profile/:uid",component:(()=>{class t{constructor(t,e,i,a,r){this.fb=t,this.userService=e,this.authService=i,this.fileUploadService=a,this.activatedRoute=r,this._baseUrl=u.N.baseUrl,this.imageUrl="",this.usuarioActual=this.authService.user,this.user={uid:"",name:"",email:"",role:"",state:!0,img:""},this.editForm=this.fb.group({name:["",[o.kI.required],[]],email:["",[o.kI.required,o.kI.email],[]],role:["",[o.kI.required],[]],state:["",[o.kI.required],[]]})}ngOnInit(){this.activatedRoute.params.pipe((0,s.w)(t=>(this.uid=t.uid,console.log("raro",this.uid),this.userService.getUsers(t.uid)))).subscribe(t=>{var e,i;this.prueba=t,this.user=this.prueba.usuario,this.editForm.patchValue({name:this.prueba.usuario.name,email:this.prueba.usuario.email}),null===(e=this.editForm.get("role"))||void 0===e||e.patchValue(this.prueba.usuario.role),null===(i=this.editForm.get("state"))||void 0===i||i.patchValue(this.prueba.usuario.state),this.imageUrl=this.getImageUrl(this.user)})}updateUser(){this.userService.updateUser(Object.assign({uid:this.uid},this.editForm.value)).subscribe(t=>{!0===t?g().fire({icon:"success",title:"La informaci\xf3n se actualizo de forma exitosa",showConfirmButton:!1,timer:1500}):g().fire("Se detecto un error al actualizar")})}changeImage(t){var e;if(this.uploadImage=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.files[0],!this.uploadImage)return;const i=new FileReader;i.readAsDataURL(this.uploadImage),i.onloadend=()=>{this.imgTemp=i.result},this.updateImage()}updateImage(){this.fileUploadService.updateImage(this.uploadImage,"usuarios",this.user.uid).then(t=>{this.user.img=t}).then(t=>this.fileUploadService.setURLImageProfile(this.getImageUrl(this.user)))}getImageUrl(t){return t.img?`${this._baseUrl}/upload/usuarios/${t.img}`:`${this._baseUrl}/upload/usuarios/no-image`}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(o.qu),n.Y36(d.K),n.Y36(l.e),n.Y36(h.J),n.Y36(r.gz))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-account-setting"]],decls:33,vars:7,consts:[[1,"row"],[1,"col-12",2,"display","flex"],["class","imgPerfil","alt","User avatar",3,"src",4,"ngIf"],[1,"header",2,"display","block"],["for","upload-photo",1,"buttonUpdatePhoto"],[1,"fas","fa-upload"],[1,"ms-2"],["id","upload-photo","type","file","accept","image/png, image/jpeg, image/jpg",1,"form-control-file",3,"change"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"col-md-6"],["appearance","outline",1,"w-100"],["matInput","","formControlName","name"],["matSuffix","",1,"me-2"],["matInput","","formControlName","email"],["matSuffix","",1,""],["class","col-md-6 ",4,"ngIf"],[1,"col-12","d-flex","flex-sm-row","flex-column","mt-2"],["type","submit","mat-stroked-button","","color","accent",3,"disabled"],["alt","User avatar",1,"imgPerfil",3,"src"],["matNativeControl","","formControlName","role"],["value","admin"],["value","biologo"],["value","encuestador"],["matPrefix","",1,"me-2"],["id","state"],["aria-labelledby","state","formControlName","state",1,"radio-group"],["color","accent",1,"radio-button",3,"value"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.YNc(2,v,1,1,"img",2),n.YNc(3,A,1,1,"img",2),n.TgZ(4,"div",3),n.TgZ(5,"h3"),n._uU(6),n.qZA(),n.TgZ(7,"label",4),n._UZ(8,"i",5),n.TgZ(9,"span",6),n._uU(10,"Subir imagen"),n.qZA(),n.qZA(),n.TgZ(11,"input",7),n.NdJ("change",function(t){return e.changeImage(t)}),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(12,"form",8),n.NdJ("ngSubmit",function(){return e.updateUser()}),n.TgZ(13,"div",0),n.TgZ(14,"div",9),n.TgZ(15,"mat-form-field",10),n.TgZ(16,"mat-label"),n._uU(17,"Nombre de usuario"),n.qZA(),n._UZ(18,"input",11),n.TgZ(19,"mat-icon",12),n._uU(20,"person"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(21,"div",9),n.TgZ(22,"mat-form-field",10),n.TgZ(23,"mat-label"),n._uU(24,"Email"),n.qZA(),n._UZ(25,"input",13),n.TgZ(26,"mat-icon",14),n._uU(27,"alternate_email"),n.qZA(),n.qZA(),n.qZA(),n.YNc(28,U,13,0,"div",15),n.YNc(29,_,10,2,"div",15),n.TgZ(30,"div",16),n.TgZ(31,"button",17),n._uU(32,"Guardar cambios"),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(2),n.Q6J("ngIf",!e.imgTemp),n.xp6(1),n.Q6J("ngIf",e.imgTemp),n.xp6(3),n.Oqu(e.user.name),n.xp6(6),n.Q6J("formGroup",e.editForm),n.xp6(16),n.Q6J("ngIf","admin"===e.usuarioActual.role),n.xp6(1),n.Q6J("ngIf","admin"===e.usuarioActual.role),n.xp6(2),n.Q6J("disabled",e.editForm.pristine))},directives:[a.O5,o._Y,o.JL,o.sg,f.KE,f.hX,Z.Nt,o.Fj,o.JJ,o.u,b.Hw,f.R9,c.lW,o.EJ,o.YN,o.Kr,f.qo,q.VQ,q.U0],styles:[".imgPerfil[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;margin:1rem}.header[_ngcontent-%COMP%]{margin-top:2rem;font-family:Helvetica,Arial,sans-serif}.buttonUpdatePhoto[_ngcontent-%COMP%]{border-radius:5px;padding:0 15px;line-height:34px;color:#ff4081;border:1px solid #0000001f}.buttonUpdatePhoto[_ngcontent-%COMP%]:hover{background-color:#ff408005}#upload-photo[_ngcontent-%COMP%]{opacity:0;position:absolute;z-index:-1}.radio-group[_ngcontent-%COMP%]{display:flex}.radio-button[_ngcontent-%COMP%]{margin:5px}"]}),t})()},{path:"update-password/:uid",component:(()=>{class t{constructor(t,e,i,a){this.fb=t,this.userService=e,this.authService=i,this.activatedRoute=a,this.hide=!0,this.hide2=!0,this.hide3=!0,this.editPassword=this.fb.group({oldPassword:["",[o.kI.required],[]],newPassword:["",[o.kI.required,o.kI.pattern(this.authService.passwordRegex)],[]],confirmPassword:["",[o.kI.required],[this.authService.samePassword]]})}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.uid=t.uid})}updatePassword(){this.userService.updatePassword(Object.assign({uid:this.uid},this.editPassword.value)).subscribe(t=>{!0===t?g().fire({icon:"success",title:"La contrase\xf1a se actualizo de forma exitosa",showConfirmButton:!1,timer:1500}):g().fire({icon:"warning",title:"Se detecto un error al actualizar",text:"Verifique su antigua contrase\xf1a y confirme la reci\xe9n ingresada"})}),this.editPassword.reset()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(o.qu),n.Y36(d.K),n.Y36(l.e),n.Y36(r.gz))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-update-password"]],inputs:{uid:"uid"},decls:38,vars:8,consts:[[1,"mb-3"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-6"],["appearance","outline",1,"w-100"],["matInput","","formControlName","oldPassword",3,"type"],["matPrefix","",1,"me-2"],["type","button","mat-icon-button","","matSuffix","",2,"opacity","0.5",3,"click"],["matInput","","formControlName","newPassword",3,"type"],["matInput","","formControlName","confirmPassword",3,"type"],[1,"col-12","d-flex","flex-sm-row","flex-column","mt-2"],["type","submit","mat-stroked-button","","color","accent",3,"disabled"]],template:function(t,e){1&t&&(n.TgZ(0,"h3",0),n._uU(1,"Actualizar contrase\xf1a"),n.qZA(),n.TgZ(2,"form",1),n.NdJ("ngSubmit",function(){return e.updatePassword()}),n.TgZ(3,"div",2),n.TgZ(4,"div",3),n.TgZ(5,"mat-form-field",4),n.TgZ(6,"mat-label"),n._uU(7,"Antigua contrase\xf1a"),n.qZA(),n._UZ(8,"input",5),n.TgZ(9,"mat-icon",6),n._uU(10,"lock"),n.qZA(),n.TgZ(11,"button",7),n.NdJ("click",function(){return e.hide=!e.hide}),n.TgZ(12,"mat-icon"),n._uU(13),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(14,"div",2),n.TgZ(15,"div",3),n.TgZ(16,"mat-form-field",4),n.TgZ(17,"mat-label"),n._uU(18,"Nueva Contrase\xf1a"),n.qZA(),n._UZ(19,"input",8),n.TgZ(20,"mat-icon",6),n._uU(21,"lock"),n.qZA(),n.TgZ(22,"button",7),n.NdJ("click",function(){return e.hide2=!e.hide2}),n.TgZ(23,"mat-icon"),n._uU(24),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(25,"div",3),n.TgZ(26,"mat-form-field",4),n.TgZ(27,"mat-label"),n._uU(28,"Confirmar contrase\xf1a"),n.qZA(),n._UZ(29,"input",9),n.TgZ(30,"mat-icon",6),n._uU(31,"lock"),n.qZA(),n.TgZ(32,"button",7),n.NdJ("click",function(){return e.hide3=!e.hide3}),n.TgZ(33,"mat-icon"),n._uU(34),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(35,"div",10),n.TgZ(36,"button",11),n._uU(37,"Guardar cambios"),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(2),n.Q6J("formGroup",e.editPassword),n.xp6(6),n.Q6J("type",e.hide?"password":"text"),n.xp6(5),n.Oqu(e.hide?"visibility_off":"visibility"),n.xp6(6),n.Q6J("type",e.hide2?"password":"text"),n.xp6(5),n.Oqu(e.hide2?"visibility_off":"visibility"),n.xp6(5),n.Q6J("type",e.hide3?"password":"text"),n.xp6(5),n.Oqu(e.hide3?"visibility_off":"visibility"),n.xp6(2),n.Q6J("disabled",e.editPassword.invalid))},directives:[o._Y,o.JL,o.sg,f.KE,f.hX,Z.Nt,o.Fj,o.JJ,o.u,b.Hw,f.qo,c.lW,f.R9],styles:[""]}),t})()}]}];let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[r.Bz.forChild(T)],r.Bz]}),t})();var x=i(4784);let I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[a.ez,w,o.UX,x.q]]}),t})()}}]);