<div class="back">
    <div class="m-5">
        <h1>Encuestas</h1>
        <hr>
        <div style="background-color: White; padding: 1em;">
            <form class="m-4 mt-4 mb-4" [formGroup]="survey" #formDirective="ngForm" (ngSubmit)="send(formDirective)" autocomplete="off">
                <div class="row">
                    <div class="col-6">
                        <mat-form-field class="w-100" appearance="outline">
                            <mat-label>Nombre de la comunidad</mat-label>
                            <input matInput formControlName="comunidad">
                            <mat-icon class="me-2" matSuffix>place</mat-icon>
                        </mat-form-field>
                    </div>
                    <hr>
                    <div class="col-12 mt-2 mb-2">
                        <h5 class="mb-2">Ingresar Especie:</h5>&nbsp;
                        <br>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Nombre Comun</mat-label>
                            <input matInput formControlName="no_nombreComun">
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Nombre Cientifico</mat-label>
                            <input matInput formControlName="no_nombreCientifico">
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Familia</mat-label>
                            <input matInput formControlName="no_familia">
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Genero</mat-label>
                            <input matInput formControlName="no_genero">
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Especie</mat-label>
                            <input matInput formControlName="no_especie">
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Sexo</mat-label>
                            <mat-select [(value)]="selected">
                                <mat-option value="M">Macho</mat-option>
                                <mat-option value="H">Hembra</mat-option>
                                <mat-option value="I">Indeterminado</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Longitud de Horquilla</mat-label>
                            <input type="number" matInput formControlName="no_longitudHorquilla">
                        </mat-form-field>
                        <mat-form-field class="width-100 m-1" appearance="outline">
                            <mat-label>Peso (gramos)</mat-label>
                            <input type="number" matInput formControlName="no_pesoGr">
                        </mat-form-field>
                        <button class="col-6 m-2" mat-raised-button type="button" color="primary" aria-label="Añadir especie" [disabled]="!especieValida()" (click)="addEspecie(formDirective)">Agregar</button>
                        <button class="col-4 m-2" mat-raised-button type="button" color="warn" aria-label="Añadir especie" (click)="clearEspeciesForm(formDirective)">Limpiar Formulario</button>
                    </div>
                    <hr>
                    <div *ngIf="isVisible()">
                        <h5>Especies agregadas:</h5><br>
                        <p-table [value]="this.especies" [autoLayout]="true" [paginator]="true" [rows]="10" styleClass="p-datatable-gridlines">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Nombre Comun</th>
                                    <th>Nombre Cientifico</th>
                                    <th>Familia</th>
                                    <th>Genero</th>
                                    <th>Especie</th>
                                    <th>Sexo</th>
                                    <th>Longitud de Horquilla</th>
                                    <th>Peso en Gramos</th>
                                    <th>Acciones</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-especie let-i="rowIndex">
                                <tr>
                                    <td>{{ especie.nombreComun }}</td>
                                    <td>{{ especie.nombreCientifico }}</td>
                                    <td>{{ especie.familia }}</td>
                                    <td>{{ especie.genero }}</td>
                                    <td>{{ especie.especie }}</td>
                                    <td>{{ especie.sexo }}</td>
                                    <td>{{ especie.longitudHorquilla }}</td>
                                    <td>{{ especie.pesoGr }}</td>
                                    <td>
                                        <button pButton type="button" class="p-button-rounded p-button-primary" (click)="editEspecie(i)" icon="pi pi-pencil" iconPos="left"></button>
                                        <button pButton pRipple type="button" icon="pi pi-times" class="p-button-rounded p-button-danger" (click)="eliminar(i)"></button>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>

                </div>
                <button class="col-12 mt-3" type="submit" mat-raised-button color="primary" [disabled]="!this.survey?.get('comunidad')?.valid">Enviar</button>
            </form>

        </div>
    </div>
</div>